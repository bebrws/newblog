<!DOCTYPE html><html><head><script type="text/javascript" class="jsx-707554062">
          
          function loadBevySnake() {
            setTimeout(function() {
            var element = document.getElementById('bevy-portal');
                  if (element) {
                    console.log('Element with id "bevy-portal" exists. Adding script tag.');

                  var script = document.createElement('script');
                  script.type = 'module';
                  script.src = '../static/load-bevy-snake.js';
                  document.head.appendChild(script);
            } else {
                    console.log('Element with id "bevy-portal" does not exist.');
                    loadBevySnake();
            }
          }, 500);
        }

        loadBevySnake();
      </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-154810525-2" class="jsx-707554062"></script><script type="text/javascript" class="jsx-707554062">
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'UA-154810525-2');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-BZKS5D8HPF" class="jsx-707554062"></script><script type="text/javascript" class="jsx-707554062">
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-BZKS5D8HPF');
        </script><meta charSet="utf-8" class="jsx-707554062"/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-707554062"/><link rel="manifest" href="/site.webmanifest" class="jsx-707554062"/><link rel="apple-touch-icon" href="/icon.png" class="jsx-707554062"/><meta name="theme-color" content="#fff" class="jsx-707554062"/><title>ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts | Brad Barrows&#x27; Blog</title><meta name="description" content="Brad Barrows&#x27; Blog"/><link rel="canonical" href="https://bbarrows.com/posts/zsh-run-last-command-empty-prompt"/><meta property="og:site_name" content="Brad Barrows&#x27; Blog"/><meta property="og:url" content="https://bbarrows.com/posts/zsh-run-last-command-empty-prompt"/><meta property="og:title" content="ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts | Brad Barrows&#x27; Blog"/><meta property="og:description" content="Brad Barrows&#x27; Blog"/><meta property="og:image" content="https://bbarrows.com/og_image.png"/><meta property="og:type" content="article"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":"https://bbarrows.com/posts/zsh-run-last-command-empty-prompt","headline":"ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts","datePublished":"2024-08-26T00:00:00-07:00","author":"Brad Barrows","description":""}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/8e11f38ccf46f6277e39.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e11f38ccf46f6277e39.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e884486185169a1848b2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e884486185169a1848b2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-f47d69457824065d04c3.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-d32200c037819e7e8fa0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-eae7af63eb651790e0a7.js" defer=""></script><script src="/_next/static/chunks/962-b2e3b32260744832b5cf.js" defer=""></script><script src="/_next/static/chunks/295-d2a92dd57ddb2277243a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpost%5D-554a7f2db08ad8e20c9d.js" defer=""></script><script src="/_next/static/lATzPuzq9Tes3x9uwms3o/_buildManifest.js" defer=""></script><script src="/_next/static/lATzPuzq9Tes3x9uwms3o/_ssgManifest.js" defer=""></script><style id="__jsx-3058196896">.container.jsx-3058196896{position:fixed;width:38px;height:38px;cursor:pointer;top:1rem;left:1.25rem;z-index:2;background-color:rgba(255,255,255,0.7);}.meat.jsx-3058196896{position:absolute;width:28px;height:2px;background:#222;top:calc(50% - 2px / 2);left:calc(50% - 28px / 2);-webkit-transition:all 150ms ease-in;transition:all 150ms ease-in;}.meat-1.jsx-3058196896{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px);}.meat-2.jsx-3058196896{width:calc(28px - 6px);}.meat-3.jsx-3058196896{-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px);}.active.jsx-3058196896 .meat-1.jsx-3058196896{-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.active.jsx-3058196896 .meat-2.jsx-3058196896{opacity:0;}.active.jsx-3058196896 .meat-3.jsx-3058196896{-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);}@media (min-width:769px){.container.jsx-3058196896{display:none;}}</style><style id="__jsx-4138737674">.container.jsx-4138737674{width:0;}ul.jsx-4138737674{opacity:0;width:100%;height:100vh;text-align:right;list-style:none;margin:0;padding:0;position:fixed;top:0;background-color:#fff;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:1;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);-webkit-transition:opacity 200ms;transition:opacity 200ms;}.active.jsx-4138737674 ul.jsx-4138737674{opacity:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}li.jsx-4138737674{margin-bottom:1.75rem;font-size:2rem;padding:0 1.5rem 0 0;}li.jsx-4138737674:last-child{margin-bottom:0;}.active.jsx-4138737674{color:#222;}@media (min-width:769px){.container.jsx-4138737674{width:7rem;display:block;}ul.jsx-4138737674{opacity:1;width:7rem;top:auto;display:block;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}li.jsx-4138737674{font-size:1rem;padding:0;}}</style><style id="__jsx-3674465219">span.jsx-3674465219{color:#9b9b9b;}</style><style id="__jsx-255066894">a.jsx-255066894{display:inline-block;}a.jsx-255066894:not(:last-child){margin-right:2em;}</style><style id="__jsx-3618008669">p.jsx-3618008669{font-size:0.75rem;text-align:center;}</style><style id="__jsx-4153080612">.container.jsx-3387257903{display:block;max-width:60rem;width:100%;margin:0 auto;padding:0 1.5rem;box-sizing:border-box;z-index:0;}.metadata.jsx-3387257903 div.jsx-3387257903{display:inline-block;margin-right:0.5rem;}article.jsx-3387257903{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}h1.jsx-3387257903{margin:0 0 0.5rem;font-size:2.25rem;}.tag-list.jsx-3387257903{list-style:none;text-align:right;margin:1.75rem 0 0 0;padding:0;}.tag-list.jsx-3387257903 li.jsx-3387257903{display:inline-block;margin-left:0.5rem;}.social-list.jsx-3387257903{margin-top:3rem;text-align:center;}@media (min-width:769px){.container.jsx-3387257903{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><style id="__jsx-1699270818">.token.comment,.token.prolog,.token.doctype,.token.cdata,.token.plain-text{color:#6a737d;}.token.atrule,.token.attr-value,.token.keyword,.token.operator{color:#d73a49;}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#22863a;}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#032f62;}.token.function,.token.class-name{color:#6f42c1;}.language-jsx .token.punctuation,.language-jsx .token.tag .token.punctuation,.language-jsx .token.tag .token.script,.language-jsx .token.plain-text{color:#24292e;}.language-jsx .token.tag .token.attr-name{color:#6f42c1;}.language-jsx .token.tag .token.class-name{color:#005cc5;}.language-jsx .token.tag .token.script-punctuation,.language-jsx .token.attr-value .token.punctuation:first-child{color:#d73a49;}.language-jsx .token.attr-value{color:#032f62;}.language-jsx span[class="comment"]{color:pink;}.language-html .token.tag .token.punctuation{color:#24292e;}.language-html .token.tag .token.attr-name{color:#6f42c1;}.language-html .token.tag .token.attr-value,.language-html .token.tag .token.attr-value .token.punctuation:not(:first-child){color:#032f62;}.language-css .token.selector{color:#6f42c1;}.language-css .token.property{color:#005cc5;}</style><style id="__jsx-707554062">.root.jsx-707554062{display:block;padding:4rem 0;box-sizing:border-box;height:100%;}main.jsx-707554062{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width:769px){.root.jsx-707554062{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}main.jsx-707554062{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}}</style></head><body><div id="__next"><div class="jsx-707554062 root"><nav class="jsx-707554062"><div class="jsx-3058196896 container "><div class="jsx-3058196896 meat meat-1"></div><div class="jsx-3058196896 meat meat-2"></div><div class="jsx-3058196896 meat meat-3"></div></div><div class="jsx-4138737674 container "><ul class="jsx-4138737674"><li class="jsx-4138737674"><a class="jsx-4138737674 " href="/">about</a></li><li class="jsx-4138737674"><a class="jsx-4138737674 " href="/projects">projects</a></li><li class="jsx-4138737674"><a class="jsx-4138737674 active" href="/posts">blog</a></li></ul></div></nav><main class="jsx-707554062"><div class="jsx-3387257903 container"><article class="jsx-3387257903"><header class="jsx-3387257903"><h1 class="jsx-3387257903">ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts</h1><div class="jsx-3387257903 metadata"><div class="jsx-3387257903"><time dateTime="2024-08-26T00:00:00-07:00" class="jsx-3674465219"><span class="jsx-3674465219">August 26, 2024</span></time></div><div class="jsx-3387257903"><span class="jsx-3674465219">Brad Barrows</span></div></div></header><div class="jsx-3387257903 content_content__1yuPc"><div><p><img src="/static/repeat-command.mov.gif" alt="A gif showing this shell script in action where after sending 2 empty command prompts the last non empty command prompt is run"/></p><h1>Why do this? What does this do?</h1><p>After running a command in the terminal, I often find myself needing to run the same command again. This is especially true when I am working on a project and need to run the same command multiple times in a row.</p><p>Or maybe I am remoting into my laptop from my phone and need to run a command that is too long to type out.</p><p>I want an easy way to run the last command again without having to type it out or use the up arrow key to find it.</p><p>So as I say in the <a href="https://github.com/bebrws/zsh_reexec">README.md</a> I have created A ZSH Plugin which will re-execute the last command you entered after so many empty commands.
The plugin uses an ENV variable named REEXEC_PROMPT_COUNT to determine how many empty commands to execute before re-executing the last command which was not empty.
The default count for empty prompts (controlled by an ENV variable) is set to 3. So starting at 0, hitting enter 4 times should rexecute the last command you typed with the default of 3 (it is counting zero based).</p><p>The default count feels like a safe number of required empty lines before running the last command. It is unlikely that I would accidentally run the last command by sending a few empty lines in a row. While being easy and quick enough to do that I can deal with the previous mentioned issues easily.</p><h1>Setup</h1><p>I have moved the usage and installation instructions to the <a href="https://github.com/bebrws/zsh_reexec">repo here</a>.</p><p>At the point of writing or really updating this blog post the contents of the plugin were as follows:</p><pre><code class="language-zsh"># Plugin to re-execute the last command after a specified number of empty prompts

# Function to initialize variables
function _reexec_init() {
  export EMPTY_PROMPT_COUNT=0
  export LAST_COMMAND=&quot;&quot;

  # Set default value for REEXEC_PROMPT_COUNT if not already set
  : ${REEXEC_PROMPT_COUNT:=3}
}

# Function to be called before each prompt
function _reexec_preexec() {
  export EMPTY_PROMPT_COUNT=0
  if [[ -n $1 ]]; then
    export LAST_COMMAND=$1
  fi
}

# Function to be called after each command
function _reexec_precmd() {
  if [[ $EMPTY_PROMPT_COUNT -eq $REEXEC_PROMPT_COUNT &amp;&amp; -n $LAST_COMMAND ]]; then
    echo &quot;Executing: $LAST_COMMAND&quot;
    eval &quot;$LAST_COMMAND&quot;
    export EMPTY_PROMPT_COUNT=0
  elif [[ -z $BUFFER ]]; then
    export EMPTY_PROMPT_COUNT=$((EMPTY_PROMPT_COUNT + 1))
  else
    export EMPTY_PROMPT_COUNT=0
  fi
}

# Set up the hooks
function _reexec_setup_hooks() {
  autoload -Uz add-zsh-hook
  add-zsh-hook preexec _reexec_preexec
  add-zsh-hook precmd _reexec_precmd
}

# Initialize and set up hooks when the plugin is loaded
_reexec_init
_reexec_setup_hooks
</code></pre><p>Follow the <a href="https://github.com/bebrws/zsh_reexec?tab=readme-ov-file#installation">instructions here</a> and you easily or lazily be rerunning whatever your working on in no time.</p></div></div></article><footer class="jsx-3387257903"><div class="jsx-3387257903 social-list"><div class="jsx-255066894"><a title="LinkedIn" href="https://www.linkedin.com/in/bbarrows/}" target="_blank" rel="noopener" class="jsx-255066894"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#222"><path fill="#444" d="M5.453 11.099v15.484H.297V11.099h5.156zm.328-4.781q.016 1.141-.789 1.906t-2.117.766h-.031q-1.281 0-2.063-.766T0 6.318q0-1.156.805-1.914t2.102-.758 2.078.758.797 1.914zM24 17.708v8.875h-5.141v-8.281q0-1.641-.633-2.57t-1.977-.93q-.984 0-1.648.539t-.992 1.336q-.172.469-.172 1.266v8.641H8.296q.031-6.234.031-10.109t-.016-4.625l-.016-.75h5.141v2.25h-.031q.312-.5.641-.875t.883-.812 1.359-.68 1.789-.242q2.672 0 4.297 1.773t1.625 5.195z"></path></svg></a><a title="GitHub" href="https://github.com/bebrws/" target="_blank" rel="noopener" class="jsx-255066894"><svg viewBox="0 0 11 11" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" width="24" height="24" fill="#222"><path d="M10.5 5.63a4.992 4.992 0 01-.977 3.016A5.018 5.018 0 016.998 10.5c-.12.022-.207.007-.263-.047a.267.267 0 01-.083-.2v-1.41c0-.432-.116-.748-.347-.948.253-.027.481-.067.683-.12.203-.054.412-.14.627-.26.216-.121.396-.27.54-.445.145-.176.263-.41.354-.702.091-.291.137-.626.137-1.005a1.95 1.95 0 00-.527-1.376c.164-.405.147-.86-.053-1.363-.125-.04-.305-.015-.54.074a3.59 3.59 0 00-.614.294l-.254.16a4.727 4.727 0 00-1.28-.174c-.44 0-.867.058-1.28.174a5.931 5.931 0 00-.284-.18 3.995 3.995 0 00-.557-.258c-.254-.1-.445-.13-.574-.09-.195.504-.211.958-.046 1.363a1.95 1.95 0 00-.527 1.376c0 .379.045.713.136 1.002.092.29.208.523.35.702.143.178.322.327.537.447.216.12.425.207.627.26.203.054.43.094.684.12-.178.161-.287.39-.327.689a1.32 1.32 0 01-.3.1 1.885 1.885 0 01-.38.034A.785.785 0 013 8.573a1.177 1.177 0 01-.37-.418 1.077 1.077 0 00-.324-.347.973.973 0 00-.33-.16l-.133-.02a.432.432 0 00-.194.03c-.035.02-.046.045-.033.077a.487.487 0 00.147.174l.046.033c.098.044.195.129.29.254.096.124.166.238.21.34l.067.154c.058.17.156.306.294.41.138.105.287.172.447.201.16.029.314.045.463.047a1.96 1.96 0 00.37-.024l.154-.026a62.026 62.026 0 00.007.955c0 .08-.03.147-.087.2-.058.054-.147.07-.267.047a5.018 5.018 0 01-2.524-1.854A4.992 4.992 0 01.255 5.63c0-.93.23-1.789.687-2.575a5.103 5.103 0 011.865-1.867A5.005 5.005 0 015.377.5c.93 0 1.787.23 2.572.688a5.103 5.103 0 011.864 1.867c.458.786.687 1.645.687 2.575z" fill="#444" fill-rule="nonzero"></path></svg></a></div></div><p class="jsx-3618008669">Â© 2021</p></footer></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts","dateString":"2024-08-26","slug":"zsh-run-last-command-empty-prompt","description":"","tags":["ZSH","shell","zsh-setup","scripting","zsh-Plugin","zsh","plugin","efficiency","productivity","lazy"],"author":"bebrws","source":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/static/repeat-command.mov.gif\",\n    \"alt\": \"A gif showing this shell script in action where after sending 2 empty command prompts the last non empty command prompt is run\"\n  })), mdx(\"h1\", null, \"Why do this? What does this do?\"), mdx(\"p\", null, \"After running a command in the terminal, I often find myself needing to run the same command again. This is especially true when I am working on a project and need to run the same command multiple times in a row.\"), mdx(\"p\", null, \"Or maybe I am remoting into my laptop from my phone and need to run a command that is too long to type out.\"), mdx(\"p\", null, \"I want an easy way to run the last command again without having to type it out or use the up arrow key to find it.\"), mdx(\"p\", null, \"So as I say in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/bebrws/zsh_reexec\"\n  }, \"README.md\"), \" I have created A ZSH Plugin which will re-execute the last command you entered after so many empty commands.\\nThe plugin uses an ENV variable named REEXEC_PROMPT_COUNT to determine how many empty commands to execute before re-executing the last command which was not empty.\\nThe default count for empty prompts (controlled by an ENV variable) is set to 3. So starting at 0, hitting enter 4 times should rexecute the last command you typed with the default of 3 (it is counting zero based).\"), mdx(\"p\", null, \"The default count feels like a safe number of required empty lines before running the last command. It is unlikely that I would accidentally run the last command by sending a few empty lines in a row. While being easy and quick enough to do that I can deal with the previous mentioned issues easily.\"), mdx(\"h1\", null, \"Setup\"), mdx(\"p\", null, \"I have moved the usage and installation instructions to the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/bebrws/zsh_reexec\"\n  }, \"repo here\"), \".\"), mdx(\"p\", null, \"At the point of writing or really updating this blog post the contents of the plugin were as follows:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-zsh\"\n  }, \"# Plugin to re-execute the last command after a specified number of empty prompts\\n\\n# Function to initialize variables\\nfunction _reexec_init() {\\n  export EMPTY_PROMPT_COUNT=0\\n  export LAST_COMMAND=\\\"\\\"\\n\\n  # Set default value for REEXEC_PROMPT_COUNT if not already set\\n  : ${REEXEC_PROMPT_COUNT:=3}\\n}\\n\\n# Function to be called before each prompt\\nfunction _reexec_preexec() {\\n  export EMPTY_PROMPT_COUNT=0\\n  if [[ -n $1 ]]; then\\n    export LAST_COMMAND=$1\\n  fi\\n}\\n\\n# Function to be called after each command\\nfunction _reexec_precmd() {\\n  if [[ $EMPTY_PROMPT_COUNT -eq $REEXEC_PROMPT_COUNT \u0026\u0026 -n $LAST_COMMAND ]]; then\\n    echo \\\"Executing: $LAST_COMMAND\\\"\\n    eval \\\"$LAST_COMMAND\\\"\\n    export EMPTY_PROMPT_COUNT=0\\n  elif [[ -z $BUFFER ]]; then\\n    export EMPTY_PROMPT_COUNT=$((EMPTY_PROMPT_COUNT + 1))\\n  else\\n    export EMPTY_PROMPT_COUNT=0\\n  fi\\n}\\n\\n# Set up the hooks\\nfunction _reexec_setup_hooks() {\\n  autoload -Uz add-zsh-hook\\n  add-zsh-hook preexec _reexec_preexec\\n  add-zsh-hook precmd _reexec_precmd\\n}\\n\\n# Initialize and set up hooks when the plugin is loaded\\n_reexec_init\\n_reexec_setup_hooks\\n\")), mdx(\"p\", null, \"Follow the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/bebrws/zsh_reexec?tab=readme-ov-file#installation\"\n  }, \"instructions here\"), \" and you easily or lazily be rerunning whatever your working on in no time.\"));\n}\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003e\u003cimg src=\"/static/repeat-command.mov.gif\" alt=\"A gif showing this shell script in action where after sending 2 empty command prompts the last non empty command prompt is run\"/\u003e\u003c/p\u003e\u003ch1\u003eWhy do this? What does this do?\u003c/h1\u003e\u003cp\u003eAfter running a command in the terminal, I often find myself needing to run the same command again. This is especially true when I am working on a project and need to run the same command multiple times in a row.\u003c/p\u003e\u003cp\u003eOr maybe I am remoting into my laptop from my phone and need to run a command that is too long to type out.\u003c/p\u003e\u003cp\u003eI want an easy way to run the last command again without having to type it out or use the up arrow key to find it.\u003c/p\u003e\u003cp\u003eSo as I say in the \u003ca href=\"https://github.com/bebrws/zsh_reexec\"\u003eREADME.md\u003c/a\u003e I have created A ZSH Plugin which will re-execute the last command you entered after so many empty commands.\nThe plugin uses an ENV variable named REEXEC_PROMPT_COUNT to determine how many empty commands to execute before re-executing the last command which was not empty.\nThe default count for empty prompts (controlled by an ENV variable) is set to 3. So starting at 0, hitting enter 4 times should rexecute the last command you typed with the default of 3 (it is counting zero based).\u003c/p\u003e\u003cp\u003eThe default count feels like a safe number of required empty lines before running the last command. It is unlikely that I would accidentally run the last command by sending a few empty lines in a row. While being easy and quick enough to do that I can deal with the previous mentioned issues easily.\u003c/p\u003e\u003ch1\u003eSetup\u003c/h1\u003e\u003cp\u003eI have moved the usage and installation instructions to the \u003ca href=\"https://github.com/bebrws/zsh_reexec\"\u003erepo here\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eAt the point of writing or really updating this blog post the contents of the plugin were as follows:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-zsh\"\u003e# Plugin to re-execute the last command after a specified number of empty prompts\n\n# Function to initialize variables\nfunction _reexec_init() {\n  export EMPTY_PROMPT_COUNT=0\n  export LAST_COMMAND=\u0026quot;\u0026quot;\n\n  # Set default value for REEXEC_PROMPT_COUNT if not already set\n  : ${REEXEC_PROMPT_COUNT:=3}\n}\n\n# Function to be called before each prompt\nfunction _reexec_preexec() {\n  export EMPTY_PROMPT_COUNT=0\n  if [[ -n $1 ]]; then\n    export LAST_COMMAND=$1\n  fi\n}\n\n# Function to be called after each command\nfunction _reexec_precmd() {\n  if [[ $EMPTY_PROMPT_COUNT -eq $REEXEC_PROMPT_COUNT \u0026amp;\u0026amp; -n $LAST_COMMAND ]]; then\n    echo \u0026quot;Executing: $LAST_COMMAND\u0026quot;\n    eval \u0026quot;$LAST_COMMAND\u0026quot;\n    export EMPTY_PROMPT_COUNT=0\n  elif [[ -z $BUFFER ]]; then\n    export EMPTY_PROMPT_COUNT=$((EMPTY_PROMPT_COUNT + 1))\n  else\n    export EMPTY_PROMPT_COUNT=0\n  fi\n}\n\n# Set up the hooks\nfunction _reexec_setup_hooks() {\n  autoload -Uz add-zsh-hook\n  add-zsh-hook preexec _reexec_preexec\n  add-zsh-hook precmd _reexec_precmd\n}\n\n# Initialize and set up hooks when the plugin is loaded\n_reexec_init\n_reexec_setup_hooks\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eFollow the \u003ca href=\"https://github.com/bebrws/zsh_reexec?tab=readme-ov-file#installation\"\u003einstructions here\u003c/a\u003e and you easily or lazily be rerunning whatever your working on in no time.\u003c/p\u003e","scope":{"slug":"zsh-run-last-command-empty-prompt","title":"ZSH Plugin to Re-Execute the Last Command After Some Number of Empty Prompts","date":"2024-08-26","author":"bebrws","tags":["ZSH","shell","zsh-setup","scripting","zsh-Plugin","zsh","plugin","efficiency","productivity","lazy"]}}},"__N_SSG":true},"page":"/posts/[post]","query":{"post":"zsh-run-last-command-empty-prompt"},"buildId":"lATzPuzq9Tes3x9uwms3o","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>