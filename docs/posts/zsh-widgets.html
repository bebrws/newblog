<!DOCTYPE html><html><head><script type="text/javascript" class="jsx-707554062">
          
          function loadBevySnake() {
            setTimeout(function() {
            var element = document.getElementById('bevy-portal');
                  if (element) {
                    console.log('Element with id "bevy-portal" exists. Adding script tag.');

                  var script = document.createElement('script');
                  script.type = 'module';
                  script.src = '../static/load-bevy-snake.js';
                  document.head.appendChild(script);
            } else {
                    console.log('Element with id "bevy-portal" does not exist.');
                    loadBevySnake();
            }
          }, 500);
        }

        loadBevySnake();
      </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-154810525-2" class="jsx-707554062"></script><script type="text/javascript" class="jsx-707554062">
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'UA-154810525-2');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-BZKS5D8HPF" class="jsx-707554062"></script><script type="text/javascript" class="jsx-707554062">
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-BZKS5D8HPF');
        </script><meta charSet="utf-8" class="jsx-707554062"/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-707554062"/><link rel="manifest" href="/site.webmanifest" class="jsx-707554062"/><link rel="apple-touch-icon" href="/icon.png" class="jsx-707554062"/><meta name="theme-color" content="#fff" class="jsx-707554062"/><title>ZSH shortcut (keybinding) to replace cursor selected word with your preset choice | Brad Barrows&#x27; Blog</title><meta name="description" content="Brad Barrows&#x27; Blog"/><link rel="canonical" href="https://bbarrows.com/posts/zsh-widgets"/><meta property="og:site_name" content="Brad Barrows&#x27; Blog"/><meta property="og:url" content="https://bbarrows.com/posts/zsh-widgets"/><meta property="og:title" content="ZSH shortcut (keybinding) to replace cursor selected word with your preset choice | Brad Barrows&#x27; Blog"/><meta property="og:description" content="Brad Barrows&#x27; Blog"/><meta property="og:image" content="https://bbarrows.com/og_image.png"/><meta property="og:type" content="article"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":"https://bbarrows.com/posts/zsh-widgets","headline":"ZSH shortcut (keybinding) to replace cursor selected word with your preset choice","datePublished":"2020-11-28T00:00:00-08:00","author":"Brad Barrows","description":""}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/8e11f38ccf46f6277e39.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e11f38ccf46f6277e39.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e884486185169a1848b2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e884486185169a1848b2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-f47d69457824065d04c3.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-d32200c037819e7e8fa0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-eae7af63eb651790e0a7.js" defer=""></script><script src="/_next/static/chunks/962-b2e3b32260744832b5cf.js" defer=""></script><script src="/_next/static/chunks/295-d2a92dd57ddb2277243a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bpost%5D-554a7f2db08ad8e20c9d.js" defer=""></script><script src="/_next/static/vLmAuvnBH1vcGrXpXTlw0/_buildManifest.js" defer=""></script><script src="/_next/static/vLmAuvnBH1vcGrXpXTlw0/_ssgManifest.js" defer=""></script><style id="__jsx-3058196896">.container.jsx-3058196896{position:fixed;width:38px;height:38px;cursor:pointer;top:1rem;left:1.25rem;z-index:2;background-color:rgba(255,255,255,0.7);}.meat.jsx-3058196896{position:absolute;width:28px;height:2px;background:#222;top:calc(50% - 2px / 2);left:calc(50% - 28px / 2);-webkit-transition:all 150ms ease-in;transition:all 150ms ease-in;}.meat-1.jsx-3058196896{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px);}.meat-2.jsx-3058196896{width:calc(28px - 6px);}.meat-3.jsx-3058196896{-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px);}.active.jsx-3058196896 .meat-1.jsx-3058196896{-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.active.jsx-3058196896 .meat-2.jsx-3058196896{opacity:0;}.active.jsx-3058196896 .meat-3.jsx-3058196896{-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);}@media (min-width:769px){.container.jsx-3058196896{display:none;}}</style><style id="__jsx-4138737674">.container.jsx-4138737674{width:0;}ul.jsx-4138737674{opacity:0;width:100%;height:100vh;text-align:right;list-style:none;margin:0;padding:0;position:fixed;top:0;background-color:#fff;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:1;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);-webkit-transition:opacity 200ms;transition:opacity 200ms;}.active.jsx-4138737674 ul.jsx-4138737674{opacity:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}li.jsx-4138737674{margin-bottom:1.75rem;font-size:2rem;padding:0 1.5rem 0 0;}li.jsx-4138737674:last-child{margin-bottom:0;}.active.jsx-4138737674{color:#222;}@media (min-width:769px){.container.jsx-4138737674{width:7rem;display:block;}ul.jsx-4138737674{opacity:1;width:7rem;top:auto;display:block;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}li.jsx-4138737674{font-size:1rem;padding:0;}}</style><style id="__jsx-3674465219">span.jsx-3674465219{color:#9b9b9b;}</style><style id="__jsx-255066894">a.jsx-255066894{display:inline-block;}a.jsx-255066894:not(:last-child){margin-right:2em;}</style><style id="__jsx-3618008669">p.jsx-3618008669{font-size:0.75rem;text-align:center;}</style><style id="__jsx-4153080612">.container.jsx-3387257903{display:block;max-width:60rem;width:100%;margin:0 auto;padding:0 1.5rem;box-sizing:border-box;z-index:0;}.metadata.jsx-3387257903 div.jsx-3387257903{display:inline-block;margin-right:0.5rem;}article.jsx-3387257903{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}h1.jsx-3387257903{margin:0 0 0.5rem;font-size:2.25rem;}.tag-list.jsx-3387257903{list-style:none;text-align:right;margin:1.75rem 0 0 0;padding:0;}.tag-list.jsx-3387257903 li.jsx-3387257903{display:inline-block;margin-left:0.5rem;}.social-list.jsx-3387257903{margin-top:3rem;text-align:center;}@media (min-width:769px){.container.jsx-3387257903{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><style id="__jsx-1699270818">.token.comment,.token.prolog,.token.doctype,.token.cdata,.token.plain-text{color:#6a737d;}.token.atrule,.token.attr-value,.token.keyword,.token.operator{color:#d73a49;}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#22863a;}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#032f62;}.token.function,.token.class-name{color:#6f42c1;}.language-jsx .token.punctuation,.language-jsx .token.tag .token.punctuation,.language-jsx .token.tag .token.script,.language-jsx .token.plain-text{color:#24292e;}.language-jsx .token.tag .token.attr-name{color:#6f42c1;}.language-jsx .token.tag .token.class-name{color:#005cc5;}.language-jsx .token.tag .token.script-punctuation,.language-jsx .token.attr-value .token.punctuation:first-child{color:#d73a49;}.language-jsx .token.attr-value{color:#032f62;}.language-jsx span[class="comment"]{color:pink;}.language-html .token.tag .token.punctuation{color:#24292e;}.language-html .token.tag .token.attr-name{color:#6f42c1;}.language-html .token.tag .token.attr-value,.language-html .token.tag .token.attr-value .token.punctuation:not(:first-child){color:#032f62;}.language-css .token.selector{color:#6f42c1;}.language-css .token.property{color:#005cc5;}</style><style id="__jsx-707554062">.root.jsx-707554062{display:block;padding:4rem 0;box-sizing:border-box;height:100%;}main.jsx-707554062{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width:769px){.root.jsx-707554062{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}main.jsx-707554062{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}}</style></head><body><div id="__next"><div class="jsx-707554062 root"><nav class="jsx-707554062"><div class="jsx-3058196896 container "><div class="jsx-3058196896 meat meat-1"></div><div class="jsx-3058196896 meat meat-2"></div><div class="jsx-3058196896 meat meat-3"></div></div><div class="jsx-4138737674 container "><ul class="jsx-4138737674"><li class="jsx-4138737674"><a class="jsx-4138737674 " href="/">about</a></li><li class="jsx-4138737674"><a class="jsx-4138737674 " href="/projects">projects</a></li><li class="jsx-4138737674"><a class="jsx-4138737674 active" href="/posts">blog</a></li></ul></div></nav><main class="jsx-707554062"><div class="jsx-3387257903 container"><article class="jsx-3387257903"><header class="jsx-3387257903"><h1 class="jsx-3387257903">ZSH shortcut (keybinding) to replace cursor selected word with your preset choice</h1><div class="jsx-3387257903 metadata"><div class="jsx-3387257903"><time dateTime="2020-11-28T00:00:00-08:00" class="jsx-3674465219"><span class="jsx-3674465219">November 28, 2020</span></time></div><div class="jsx-3387257903"><span class="jsx-3674465219">Brad Barrows</span></div></div></header><div class="jsx-3387257903 content_content__1yuPc"><div><h1>ZSH Is Amazingly Powerful</h1><p>One of my favorite features is actually it&#x27;s &quot;line editor&quot; Zle.</p><p>Zle is what powers ZSH&#x27; input. It provides a quick and easy way to jump through words and syntax, forwards and backwards, providing powerful features all for the sole function of editing one single line (usually - of course it can do more).</p><p>So far, I have found that the easiest way to use Zle is with ZSH Widgets.</p><p>These Widgets can be bound to keys with bind-key. In this Widgets you are allowed to use the Zle line editor and there you can do cool things like show a message below the prompt. Take input below the prompt. Edit the current prompt. Read the current text being entered into the prompt. Etc etc..</p><p>To send keys to the terminal, effectively typing where your cursor currently is you can run:</p><pre><code>export AVAR=&quot;STRING&quot;; Zle -U $AVAR
</code></pre><p>and STRING will appear where your cursor is as if you had typed it.</p><p>It is amazing how powerful a shell can be. You have zsh hooks to run zsh functions on certain events such as changing directories or on signals, you can edit, view and analyze the current prompt all the while having the ability to run processes and manipulate the output.</p><h2>Creating a ZSH Widget</h2><p>I use fzf so that I can quickly script user interfaces that are fast and easy to use. This is going to be another widget where I end up using fzf to take care of what could potentially be a repetitive and annoying task.</p><p>Use case and a question:</p><p>There are always multiple versions of clang and ar installed on my laptop. The compiler and linker that ships with OSX and that come with XCode are different.</p><p>I don&#x27;t know why and would love to know actually if anyone can tell me why the ar binary (linker) that is part of a fresh OSX install won&#x27;t create binaries that can be linked or compiled with another clang build. ( This is not an issue with libtool. ) I get error messages sometimes saying that clang is trying to link a file for architecure A with the same arcitecture A. (It will say something like &quot;unable to link the binary compiled for x86_64 with the other x86_64 binary&quot;.)</p><p>Anyhow, I hate using xcrun to find the location of the toolchain files and sometimes require CFLAGS or linker arguments and other things I want to quickly look up (and I don&#x27;t want in an environment variable). So I created the following:</p><pre><code>function replacecurrentword() {
    export CURRENTWORD=&quot;${LBUFFER/* /}${RBUFFER/ */}&quot;

    Zle kill-word
    Zle backward-kill-word

  if [ -z &quot;$CURRENTWORD&quot; ]; then
    export REPLACEMENT=&quot;$(cat ~/.my_inserts| fzf  )&quot;
  else
    export REPLACEMENT=&quot;$(cat ~/.my_inserts| fzf  -q $CURRENTWORD)&quot;
  fi

    Zle -M &quot;Replacing $CURRENTWORD with $REPLACEMENT&quot;

    Zle -U &quot;$REPLACEMENT&quot;
}
Zle -N replacecurrentword
bindkey &quot;^rr&quot; replacecurrentword
</code></pre><p>Now this is bound to the following:
Control + r + r</p><p>Then I go and create a file at ~/.my_inserts</p><p>Currently mine looks like:</p><pre><code>/usr/local/Cellar/llvm/11.0.0/bin/clang
/usr/local/Cellar/llvm/11.0.0/bin/ar
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ar
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang  -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk
</code></pre><p>Now I can be typing say:</p><pre><code>./configure CC= clang
</code></pre><p>and with my cursor over clang I can hit Control + r + r</p><p>Then select one of the clang strings I have selected to set the compiler for the configuration script.</p><p>I may need to jump back and add some quotes around the replaced string in this example, but in most cases I wouldnt&#x27;t. Only if I had to deal with some OSX specific file path probably and was required to monkey around with sysroot.</p><p>This function could do that.. it could do a lot of things most likely</p><h2>An Extra Couple Scripts</h2><h3>Assuming you have a directory named repos in your home directory that you travel to often</h3><p>With this you can begin typing a directory, then lazily or hastily hit</p><p>Control + r + r</p><p>Then fzf will popup with the word you were typing already into the search and you can select one of the repos you want to goto.</p><p>The only requirements for ALL of this functionality is 1. fzf binary:</p><pre><code>brew install fzf
</code></pre><p>and 1. zsh which comes standard with OSX now.</p><pre><code>
function goto_repos_dir_fzf() {
  export CURRENTWORD=&quot;${LBUFFER/* /}${RBUFFER/ */}&quot;

    Zle kill-word
    Zle backward-kill-word


    if [ -z &quot;$CURRENTWORD&quot; ]; then
    eval code &quot;$HOME/repos/$(ls ~/repos | fzf)&quot;
  else
    eval code &quot;$HOME/repos/$(ls ~/repos | fzf -q $CURRENTWORD)&quot;
  fi
}
Zle -N goto_repos_dir_fzf
bindkey &quot;^re&quot; goto_repos_dir_fzf
</code></pre><h3>Killing Processes</h3><p>If there are a few processes you need to get rid of. You could:</p><pre><code>
function kill_process_using_fzf() {
  export CURRENTWORD=&quot;${LBUFFER/* /}${RBUFFER/ */}&quot;

  Zle kill-word
  Zle backward-kill-word

  if [ -z &quot;$CURRENTWORD&quot; ]; then
    sudo kill -9 $(ps -efc | fzf -m  | awk &#x27;{print $2}&#x27;)
  else
    sudo kill -9 $(ps -efc | fzf -m -q $CURRENTWORD | awk &#x27;{print $2}&#x27;)
  fi
}
Zle -N kill_process_using_fzf
bindkey &quot;^pp&quot; kill_process_using_fzf

</code></pre><p>Control + p + p now will bring up a nice menu where you can use the tab key to select multiple processes. On enter they will be killed.</p></div></div></article><footer class="jsx-3387257903"><div class="jsx-3387257903 social-list"><div class="jsx-255066894"><a title="LinkedIn" href="https://www.linkedin.com/in/bbarrows/}" target="_blank" rel="noopener" class="jsx-255066894"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#222"><path fill="#444" d="M5.453 11.099v15.484H.297V11.099h5.156zm.328-4.781q.016 1.141-.789 1.906t-2.117.766h-.031q-1.281 0-2.063-.766T0 6.318q0-1.156.805-1.914t2.102-.758 2.078.758.797 1.914zM24 17.708v8.875h-5.141v-8.281q0-1.641-.633-2.57t-1.977-.93q-.984 0-1.648.539t-.992 1.336q-.172.469-.172 1.266v8.641H8.296q.031-6.234.031-10.109t-.016-4.625l-.016-.75h5.141v2.25h-.031q.312-.5.641-.875t.883-.812 1.359-.68 1.789-.242q2.672 0 4.297 1.773t1.625 5.195z"></path></svg></a><a title="GitHub" href="https://github.com/bebrws/" target="_blank" rel="noopener" class="jsx-255066894"><svg viewBox="0 0 11 11" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" width="24" height="24" fill="#222"><path d="M10.5 5.63a4.992 4.992 0 01-.977 3.016A5.018 5.018 0 016.998 10.5c-.12.022-.207.007-.263-.047a.267.267 0 01-.083-.2v-1.41c0-.432-.116-.748-.347-.948.253-.027.481-.067.683-.12.203-.054.412-.14.627-.26.216-.121.396-.27.54-.445.145-.176.263-.41.354-.702.091-.291.137-.626.137-1.005a1.95 1.95 0 00-.527-1.376c.164-.405.147-.86-.053-1.363-.125-.04-.305-.015-.54.074a3.59 3.59 0 00-.614.294l-.254.16a4.727 4.727 0 00-1.28-.174c-.44 0-.867.058-1.28.174a5.931 5.931 0 00-.284-.18 3.995 3.995 0 00-.557-.258c-.254-.1-.445-.13-.574-.09-.195.504-.211.958-.046 1.363a1.95 1.95 0 00-.527 1.376c0 .379.045.713.136 1.002.092.29.208.523.35.702.143.178.322.327.537.447.216.12.425.207.627.26.203.054.43.094.684.12-.178.161-.287.39-.327.689a1.32 1.32 0 01-.3.1 1.885 1.885 0 01-.38.034A.785.785 0 013 8.573a1.177 1.177 0 01-.37-.418 1.077 1.077 0 00-.324-.347.973.973 0 00-.33-.16l-.133-.02a.432.432 0 00-.194.03c-.035.02-.046.045-.033.077a.487.487 0 00.147.174l.046.033c.098.044.195.129.29.254.096.124.166.238.21.34l.067.154c.058.17.156.306.294.41.138.105.287.172.447.201.16.029.314.045.463.047a1.96 1.96 0 00.37-.024l.154-.026a62.026 62.026 0 00.007.955c0 .08-.03.147-.087.2-.058.054-.147.07-.267.047a5.018 5.018 0 01-2.524-1.854A4.992 4.992 0 01.255 5.63c0-.93.23-1.789.687-2.575a5.103 5.103 0 011.865-1.867A5.005 5.005 0 015.377.5c.93 0 1.787.23 2.572.688a5.103 5.103 0 011.864 1.867c.458.786.687 1.645.687 2.575z" fill="#444" fill-rule="nonzero"></path></svg></a></div></div><p class="jsx-3618008669">Â© 2021</p></footer></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"ZSH shortcut (keybinding) to replace cursor selected word with your preset choice","dateString":"2020-11-28","slug":"zsh-widgets","description":"","tags":["zsh"],"author":"bebrws","source":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"ZSH Is Amazingly Powerful\"), mdx(\"p\", null, \"One of my favorite features is actually it's \\\"line editor\\\" Zle.\"), mdx(\"p\", null, \"Zle is what powers ZSH' input. It provides a quick and easy way to jump through words and syntax, forwards and backwards, providing powerful features all for the sole function of editing one single line (usually - of course it can do more).\"), mdx(\"p\", null, \"So far, I have found that the easiest way to use Zle is with ZSH Widgets.\"), mdx(\"p\", null, \"These Widgets can be bound to keys with bind-key. In this Widgets you are allowed to use the Zle line editor and there you can do cool things like show a message below the prompt. Take input below the prompt. Edit the current prompt. Read the current text being entered into the prompt. Etc etc..\"), mdx(\"p\", null, \"To send keys to the terminal, effectively typing where your cursor currently is you can run:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"export AVAR=\\\"STRING\\\"; Zle -U $AVAR\\n\")), mdx(\"p\", null, \"and STRING will appear where your cursor is as if you had typed it.\"), mdx(\"p\", null, \"It is amazing how powerful a shell can be. You have zsh hooks to run zsh functions on certain events such as changing directories or on signals, you can edit, view and analyze the current prompt all the while having the ability to run processes and manipulate the output.\"), mdx(\"h2\", null, \"Creating a ZSH Widget\"), mdx(\"p\", null, \"I use fzf so that I can quickly script user interfaces that are fast and easy to use. This is going to be another widget where I end up using fzf to take care of what could potentially be a repetitive and annoying task.\"), mdx(\"p\", null, \"Use case and a question:\"), mdx(\"p\", null, \"There are always multiple versions of clang and ar installed on my laptop. The compiler and linker that ships with OSX and that come with XCode are different.\"), mdx(\"p\", null, \"I don't know why and would love to know actually if anyone can tell me why the ar binary (linker) that is part of a fresh OSX install won't create binaries that can be linked or compiled with another clang build. ( This is not an issue with libtool. ) I get error messages sometimes saying that clang is trying to link a file for architecure A with the same arcitecture A. (It will say something like \\\"unable to link the binary compiled for x86_64 with the other x86_64 binary\\\".)\"), mdx(\"p\", null, \"Anyhow, I hate using xcrun to find the location of the toolchain files and sometimes require CFLAGS or linker arguments and other things I want to quickly look up (and I don't want in an environment variable). So I created the following:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"function replacecurrentword() {\\n    export CURRENTWORD=\\\"${LBUFFER/* /}${RBUFFER/ */}\\\"\\n\\n    Zle kill-word\\n    Zle backward-kill-word\\n\\n  if [ -z \\\"$CURRENTWORD\\\" ]; then\\n    export REPLACEMENT=\\\"$(cat ~/.my_inserts| fzf  )\\\"\\n  else\\n    export REPLACEMENT=\\\"$(cat ~/.my_inserts| fzf  -q $CURRENTWORD)\\\"\\n  fi\\n\\n    Zle -M \\\"Replacing $CURRENTWORD with $REPLACEMENT\\\"\\n\\n    Zle -U \\\"$REPLACEMENT\\\"\\n}\\nZle -N replacecurrentword\\nbindkey \\\"^rr\\\" replacecurrentword\\n\")), mdx(\"p\", null, \"Now this is bound to the following:\\nControl + r + r\"), mdx(\"p\", null, \"Then I go and create a file at ~/.my_inserts\"), mdx(\"p\", null, \"Currently mine looks like:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"/usr/local/Cellar/llvm/11.0.0/bin/clang\\n/usr/local/Cellar/llvm/11.0.0/bin/ar\\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang\\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ar\\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib\\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld\\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang  -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk\\n\")), mdx(\"p\", null, \"Now I can be typing say:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"./configure CC= clang\\n\")), mdx(\"p\", null, \"and with my cursor over clang I can hit Control + r + r\"), mdx(\"p\", null, \"Then select one of the clang strings I have selected to set the compiler for the configuration script.\"), mdx(\"p\", null, \"I may need to jump back and add some quotes around the replaced string in this example, but in most cases I wouldnt't. Only if I had to deal with some OSX specific file path probably and was required to monkey around with sysroot.\"), mdx(\"p\", null, \"This function could do that.. it could do a lot of things most likely\"), mdx(\"h2\", null, \"An Extra Couple Scripts\"), mdx(\"h3\", null, \"Assuming you have a directory named repos in your home directory that you travel to often\"), mdx(\"p\", null, \"With this you can begin typing a directory, then lazily or hastily hit\"), mdx(\"p\", null, \"Control + r + r\"), mdx(\"p\", null, \"Then fzf will popup with the word you were typing already into the search and you can select one of the repos you want to goto.\"), mdx(\"p\", null, \"The only requirements for ALL of this functionality is 1. fzf binary:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"brew install fzf\\n\")), mdx(\"p\", null, \"and 1. zsh which comes standard with OSX now.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\nfunction goto_repos_dir_fzf() {\\n  export CURRENTWORD=\\\"${LBUFFER/* /}${RBUFFER/ */}\\\"\\n\\n    Zle kill-word\\n    Zle backward-kill-word\\n\\n\\n    if [ -z \\\"$CURRENTWORD\\\" ]; then\\n    eval code \\\"$HOME/repos/$(ls ~/repos | fzf)\\\"\\n  else\\n    eval code \\\"$HOME/repos/$(ls ~/repos | fzf -q $CURRENTWORD)\\\"\\n  fi\\n}\\nZle -N goto_repos_dir_fzf\\nbindkey \\\"^re\\\" goto_repos_dir_fzf\\n\")), mdx(\"h3\", null, \"Killing Processes\"), mdx(\"p\", null, \"If there are a few processes you need to get rid of. You could:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\nfunction kill_process_using_fzf() {\\n  export CURRENTWORD=\\\"${LBUFFER/* /}${RBUFFER/ */}\\\"\\n\\n  Zle kill-word\\n  Zle backward-kill-word\\n\\n  if [ -z \\\"$CURRENTWORD\\\" ]; then\\n    sudo kill -9 $(ps -efc | fzf -m  | awk '{print $2}')\\n  else\\n    sudo kill -9 $(ps -efc | fzf -m -q $CURRENTWORD | awk '{print $2}')\\n  fi\\n}\\nZle -N kill_process_using_fzf\\nbindkey \\\"^pp\\\" kill_process_using_fzf\\n\\n\")), mdx(\"p\", null, \"Control + p + p now will bring up a nice menu where you can use the tab key to select multiple processes. On enter they will be killed.\"));\n}\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003ch1\u003eZSH Is Amazingly Powerful\u003c/h1\u003e\u003cp\u003eOne of my favorite features is actually it\u0026#x27;s \u0026quot;line editor\u0026quot; Zle.\u003c/p\u003e\u003cp\u003eZle is what powers ZSH\u0026#x27; input. It provides a quick and easy way to jump through words and syntax, forwards and backwards, providing powerful features all for the sole function of editing one single line (usually - of course it can do more).\u003c/p\u003e\u003cp\u003eSo far, I have found that the easiest way to use Zle is with ZSH Widgets.\u003c/p\u003e\u003cp\u003eThese Widgets can be bound to keys with bind-key. In this Widgets you are allowed to use the Zle line editor and there you can do cool things like show a message below the prompt. Take input below the prompt. Edit the current prompt. Read the current text being entered into the prompt. Etc etc..\u003c/p\u003e\u003cp\u003eTo send keys to the terminal, effectively typing where your cursor currently is you can run:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003eexport AVAR=\u0026quot;STRING\u0026quot;; Zle -U $AVAR\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eand STRING will appear where your cursor is as if you had typed it.\u003c/p\u003e\u003cp\u003eIt is amazing how powerful a shell can be. You have zsh hooks to run zsh functions on certain events such as changing directories or on signals, you can edit, view and analyze the current prompt all the while having the ability to run processes and manipulate the output.\u003c/p\u003e\u003ch2\u003eCreating a ZSH Widget\u003c/h2\u003e\u003cp\u003eI use fzf so that I can quickly script user interfaces that are fast and easy to use. This is going to be another widget where I end up using fzf to take care of what could potentially be a repetitive and annoying task.\u003c/p\u003e\u003cp\u003eUse case and a question:\u003c/p\u003e\u003cp\u003eThere are always multiple versions of clang and ar installed on my laptop. The compiler and linker that ships with OSX and that come with XCode are different.\u003c/p\u003e\u003cp\u003eI don\u0026#x27;t know why and would love to know actually if anyone can tell me why the ar binary (linker) that is part of a fresh OSX install won\u0026#x27;t create binaries that can be linked or compiled with another clang build. ( This is not an issue with libtool. ) I get error messages sometimes saying that clang is trying to link a file for architecure A with the same arcitecture A. (It will say something like \u0026quot;unable to link the binary compiled for x86_64 with the other x86_64 binary\u0026quot;.)\u003c/p\u003e\u003cp\u003eAnyhow, I hate using xcrun to find the location of the toolchain files and sometimes require CFLAGS or linker arguments and other things I want to quickly look up (and I don\u0026#x27;t want in an environment variable). So I created the following:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003efunction replacecurrentword() {\n    export CURRENTWORD=\u0026quot;${LBUFFER/* /}${RBUFFER/ */}\u0026quot;\n\n    Zle kill-word\n    Zle backward-kill-word\n\n  if [ -z \u0026quot;$CURRENTWORD\u0026quot; ]; then\n    export REPLACEMENT=\u0026quot;$(cat ~/.my_inserts| fzf  )\u0026quot;\n  else\n    export REPLACEMENT=\u0026quot;$(cat ~/.my_inserts| fzf  -q $CURRENTWORD)\u0026quot;\n  fi\n\n    Zle -M \u0026quot;Replacing $CURRENTWORD with $REPLACEMENT\u0026quot;\n\n    Zle -U \u0026quot;$REPLACEMENT\u0026quot;\n}\nZle -N replacecurrentword\nbindkey \u0026quot;^rr\u0026quot; replacecurrentword\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow this is bound to the following:\nControl + r + r\u003c/p\u003e\u003cp\u003eThen I go and create a file at ~/.my_inserts\u003c/p\u003e\u003cp\u003eCurrently mine looks like:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003e/usr/local/Cellar/llvm/11.0.0/bin/clang\n/usr/local/Cellar/llvm/11.0.0/bin/ar\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ar\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang  -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow I can be typing say:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003e./configure CC= clang\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eand with my cursor over clang I can hit Control + r + r\u003c/p\u003e\u003cp\u003eThen select one of the clang strings I have selected to set the compiler for the configuration script.\u003c/p\u003e\u003cp\u003eI may need to jump back and add some quotes around the replaced string in this example, but in most cases I wouldnt\u0026#x27;t. Only if I had to deal with some OSX specific file path probably and was required to monkey around with sysroot.\u003c/p\u003e\u003cp\u003eThis function could do that.. it could do a lot of things most likely\u003c/p\u003e\u003ch2\u003eAn Extra Couple Scripts\u003c/h2\u003e\u003ch3\u003eAssuming you have a directory named repos in your home directory that you travel to often\u003c/h3\u003e\u003cp\u003eWith this you can begin typing a directory, then lazily or hastily hit\u003c/p\u003e\u003cp\u003eControl + r + r\u003c/p\u003e\u003cp\u003eThen fzf will popup with the word you were typing already into the search and you can select one of the repos you want to goto.\u003c/p\u003e\u003cp\u003eThe only requirements for ALL of this functionality is 1. fzf binary:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003ebrew install fzf\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eand 1. zsh which comes standard with OSX now.\u003c/p\u003e\u003cpre\u003e\u003ccode\u003e\nfunction goto_repos_dir_fzf() {\n  export CURRENTWORD=\u0026quot;${LBUFFER/* /}${RBUFFER/ */}\u0026quot;\n\n    Zle kill-word\n    Zle backward-kill-word\n\n\n    if [ -z \u0026quot;$CURRENTWORD\u0026quot; ]; then\n    eval code \u0026quot;$HOME/repos/$(ls ~/repos | fzf)\u0026quot;\n  else\n    eval code \u0026quot;$HOME/repos/$(ls ~/repos | fzf -q $CURRENTWORD)\u0026quot;\n  fi\n}\nZle -N goto_repos_dir_fzf\nbindkey \u0026quot;^re\u0026quot; goto_repos_dir_fzf\n\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003eKilling Processes\u003c/h3\u003e\u003cp\u003eIf there are a few processes you need to get rid of. You could:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003e\nfunction kill_process_using_fzf() {\n  export CURRENTWORD=\u0026quot;${LBUFFER/* /}${RBUFFER/ */}\u0026quot;\n\n  Zle kill-word\n  Zle backward-kill-word\n\n  if [ -z \u0026quot;$CURRENTWORD\u0026quot; ]; then\n    sudo kill -9 $(ps -efc | fzf -m  | awk \u0026#x27;{print $2}\u0026#x27;)\n  else\n    sudo kill -9 $(ps -efc | fzf -m -q $CURRENTWORD | awk \u0026#x27;{print $2}\u0026#x27;)\n  fi\n}\nZle -N kill_process_using_fzf\nbindkey \u0026quot;^pp\u0026quot; kill_process_using_fzf\n\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eControl + p + p now will bring up a nice menu where you can use the tab key to select multiple processes. On enter they will be killed.\u003c/p\u003e","scope":{"slug":"zsh-widgets","title":"ZSH shortcut (keybinding) to replace cursor selected word with your preset choice","date":"2020-11-28","author":"bebrws","tags":["zsh"]}}},"__N_SSG":true},"page":"/posts/[post]","query":{"post":"zsh-widgets"},"buildId":"vLmAuvnBH1vcGrXpXTlw0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>